
<!DOCTYPE HTML >
<html>


<head>
<meta charset="UTF-8"  lang="ua">
<meta name="description" content=" Зміна SQL-виразу (Injection), впровадження зловмисного коду в SQL-вираз. Основи навчання Системи Керування Бази Даних. Синтаксис SQL запитів. Навчальні статті з ресурсу w3schools.com" />
<meta name="keywords" content="MySQL, статті MySQL, навчання MySQL, Системи Керування Даними, синтаксис SQL, База Даних, Injection, Injection в SQL, SQL Injection" />

<TITLE>Шаблон вибірки даних з таблиць Бази Даних</TITLE>


<link href='http://fonts.googleapis.com/css?family=Marck+Script|Lobster&subset=cyrillic' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
</head>

<style type="text/css">
html, body { margin: 0;padding: 0; border: 0;outline: 0; font-size: 100%;vertical-align: baseline; background-color:#ADFF85; }
td {border-bottom-width: 1px;border-bottom-style:solid;border-bottom-color: #dcdcdc; }

.ttl_01 {color:#B22222}

.article_link {color: #196803;text-decoration:none;border-bottom-color:#7ddb1f;border-bottom-width: 1px; border-bottom-style:solid ;}
.article_link:hover {color: #196803;text-decoration:none;border-bottom-color:#468704;border-bottom-width: 1px; border-bottom-style:solid ;}
 
.w3c_link {background-color:#ADFF85;color: #196803;text-decoration:none;border-color:#ADFF85;border-width: 1px; border-style:solid;border-radius:3px;padding:3px}
.w3c_link:hover {background-color:#ffffff;color: #196803;text-decoration:none;border-color:#ADFF85;border-width: 1px; border-style:solid;border-radius:3px;padding:3px}

.wrap_site_nav{width:100%;position:fixed;top:0px;z-index:3}
.site_nav {width:960px;height:50px;text-align:center;background-color:#fffccd;position:relative;box-shadow: 2px 2px 5px 2px #444444;z-index:3;border-bottom-right-radius:9px;;border-bottom-left-radius:9px;}

.header {width:960px;height:50px;}
.content {width:920px;min-height:1000px;text-align:left;position:relative;background:url(http://bestwebit.biz.ua/mysql/kletka.png);box-shadow: 2px 2px 5px 2px #444444;padding:20px;margin-bottom:35px;z-index:1}
.footer {width:920px;height:250px;}
.clear {clear:both}
.exemple_code {background-color:#ffffff;padding:10px;border-left-width: 3px;border-left-style:solid;border-left-color:#ADFF85; border-radius:3px }
.execute_code {background-color:#ffffff;padding:10px;border-width: 3px;border-style:solid;border-color:#8470FF; border-radius:3px }
.kod_01 {text-align:center;background-color:#DCDCDC;border-bottom-color:#ffffff;border-bottom-width: 1px; border-bottom-style:solid ;}
.kod_02 {color:#0000FF;padding-left:10px;border-bottom-color:#DCDCDC;border-bottom-width: 1px; border-bottom-style:solid ;}


</style >










<body >
<div align="center">






<div align="center" class="wrap_site_nav">
<div  class="site_nav">
<div style="position:absolute;left:5%;top:-15px"><h1 class="best_blog_ttl_05">Мої статті </h1>
</div>
<div style="position:absolute;left:30%;top:10px;background-color:#FFFF00;border-color:#7ddb1f;border-width:1px; border-style:dashed;border-radius:5px;padding:5px;">
<a class="article_link" href="http://bestwebit.biz.ua/pages/mysql_00_main.html" > Зміст MySql    </a> &nbsp;&nbsp;&nbsp;
</div>
<div style="position:absolute;left:50%;top:15px">
<a class="article_link" href="http://bestwebit.biz.ua/" > Головна    </a> &nbsp;&nbsp;&nbsp;
<a class="article_link" href="http://bestwebit.biz.ua/pages/article.html" > Статті   </a>&nbsp;&nbsp;&nbsp;
<a class="article_link" href="http://bestwebit.biz.ua/pages/best_1_1_blog.html" > Блог   </a>&nbsp;&nbsp;&nbsp;
<a class="article_link" href="http://bestwebit.biz.ua/pages/best_1_1_chat.php" > Зворотній зв&#39;язок   </a>&nbsp;&nbsp;&nbsp;
</div>
</div>
</div>



 




<div class="header">
</div>






<div class="content">
<br><br>






<h2>Шаблон вибірки даних з таблиць Бази Даних</h2>

<p> 
&nbsp;&nbsp;&nbsp; Розглянемо шаблони вибірки даних з таблиць, розпочинаючи від простіших і в напрямку вибірки даних в дещо складнішому варіанті з двох та трьох таблиць. 
</p>


 <img src="4/table_01.png" width="627px" >
<p align="center"><em>Вибір даних з однієї таблиці
</em> 
</p>

<form action="handler.php">
   <p><strong>Укажите картинку в формате JPEG, PNG или GIF</strong></p>
   <input type="hidden" name="MAX_FILE_SIZE" value="30000">
   <p><input type="file" name="img" accept="image/jpeg,image/png,image/gif">
   <input type="submit" value="Отправить"></p>
  </form>
$_FILES['userfile']['name'] - оригинальное имя файла, такое, каким его видел пользователь, выбирая файл;
$_FILES['userfile']['type'] - mime/type файла, к примеру, может быть image/gif; это поле полезно сохранить, если Вы хотите предоставлять интерфейс для скачивания загруженных файлов;
$_FILES['userfile']['size'] - размер загруженного файла;
$_FILES['userfile']['tmp_name'] - полный путь к временному файлу на диске;
$_FILES['userfile']['error'] - Начиная с версии 4.2.0, содержит код ошибки, который равен 0, если операция прошла успешно.
Хранение файлов в базе данных mySQL

Если Вы собрались хранить загружаемы файлы в базе данных, Вам необходимо помнить следующие моменты:

Необходимо использовать поле типа BLOB
Перед тем, как класть в базу, не забыть применить к строке mysql_escape_string
При отображении файла необходимо указывать заголовок content/type
Помните, что скрипт отображающий ваш HTML никак не связан со скриптом, который должен выводить изображение. Это должны быть два различные приложения.

Хранение картинок в базе не является хорошем стилем. Гораздо удобней хранить в базе лишь пути к файлам изображений.




<?
$max_image_width	= 380;
$max_image_height	= 600;
$max_image_size		= 64 * 1024;
$valid_types 		=  array("gif","jpg", "png", "jpeg");

if (isset($_FILES["userfile"])) {
	if (is_uploaded_file($_FILES['userfile']['tmp_name'])) {
		$filename = $_FILES['userfile']['tmp_name'];
		$ext = substr($_FILES['userfile']['name'], 
			1 + strrpos($_FILES['userfile']['name'], "."));
		if (filesize($filename) > $max_image_size) {
			echo 'Error: File size > 64K.';
		} elseif (!in_array($ext, $valid_types)) {
			echo 'Error: Invalid file type.';
		} else {
 			$size = GetImageSize($filename);
 			if (($size) && ($size[0] < $max_image_width) 
				&& ($size[1] < $max_image_height)) {
				if (@move_uploaded_file($filename, "/www/htdocs/upload/")) {
					echo 'File successful uploaded.';
				} else {
					echo 'Error: moving fie failed.';
				}
			} else {
				echo 'Error: invalid image properties.';
			}
		}
	} else {
		echo "Error: empty file.";
	}
} else {
	echo  '
	<form enctype="multipart/form-data" method="post"> 
	<input type="hidden" name="MAX_FILE_SIZE" value="64000"> 
	Send this file: <input name="userfile" type="file"> 
	<input type="submit" value="Send File"> 
	</form>';
}
?>



http://ru2.php.net/move_uploaded_file



if (empty($_FILES['avatar']['type']))
    {
        echo "$<p class=wide_small><span class=attention>Ошибка!</span>Вы не выбрали фаил.</p>";
    }
 
if(!empty($_FILES['avatar']))
{
    if($_FILES["avatar"]["size"] > 0)
    {
           if($_FILES["avatar"]["size"] > 1024*1024*0.31)
           {
                {$err_message .= "<p class=kurs><span class=attention>Ошибка!</span>ФаиМ†л очень велик. Разрешена загрузка баннеров не более чем в 300 килобаиМ†т.</p>";}
           }
          if(!getimagesize($_FILES["avatar"]["tmp_name"]))
          {
               echo "<span class=rur>Внимание!</span>Изображение аватар может иметь расширение только следующих типов: jpg, gif, png, jpeg.</p>";
          }
    }
}















if(preg_match('/\\.(jpe?g|png|gif)$/i',$_FILES['avatar']['name'], $matches))
{
    $ext = $matches[1] == 'jpg' ? 'jpeg' : $matches[1];
    $filename = 'image' . time() . '.' . $ext;
    $create = 'imagecreatefrom' . $ext;
    $im = $create($_FILES['avatar']['tmp_name']);
    if(!$im)
    {
        //ошибка
    }
    else
    {
        move_uploaded_file($_FILES['avatar']['tmp_name'], $path_directory . $filename);
        $w = 100;//ширина
        $w2 = 100; //высота 
        list($w_src, $h_src) = getimagesize($_FILES['avatar']['tmp_name']);
        if($w_src == $w and $h_src == $w2)
        {
            // запись в базу .......
        }
        else
        {
            echo "Не верный размер АВАТАР. Допустимый размер 100х100px";
        }
        imagedestroy($im);
    }
}
else
{
    echo "Аватар должен быть в формате <strong>JPG,GIF или PNG</strong>";
}





</div>
</body>
</html>